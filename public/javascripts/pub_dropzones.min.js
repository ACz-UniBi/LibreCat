$(document).ready(function(){Dropzone.options.qaeUpload={url:"/myPUB/upload",maxFileSize:1e3,maxFiles:1,previewTemplate:"<span></span>",params:{access_level:"open_access",accept:1,quickandeasy:1},createImageThumbnails:!1,dictDefaultMessage:'<span class="fa fa-file-pdf-o fa-3x"></span><br />Drop Open Access fulltext (pdf) here and we\'ll do the rest.',dictMaxFilesExceeded:"Please submit or cancel your upload first before uploading more files.",init:function(){$(".dz-default.dz-message").addClass("qae"),this.on("addedfile",function(e){var a=Dropzone.createElement('<div class="row"><div class="progress progress-striped active"><div class="progress-bar" id="'+e.name+'_progress" style="width:0;text-align:left;padding-left:10px;">'+e.name+"</span></div></div></div>");e.previewElement.appendChild(a)}),this.on("uploadprogress",function(e,a){var t=document.getElementById(e.name+"_progress");t.style.width=a+"%"}),this.on("success",function(e,a){var t=document.getElementById(e.name+"_progress"),s=t.parentNode.parentNode;$(s).remove();var l=a,i=Dropzone.createElement("<div class='well' id='"+l.tempname+"'><form id='form_"+l.tempname+"' action='/myPUB/upload/qae/submit' method='post'><strong>"+e.name+"</strong><textarea class='form-control' placeholder='Type details about your publication here' name='description'></textarea><input type='hidden' name='file_name' value='"+l.file_name+"' /><div class='checkbox'><label><input type='checkbox' required> I have read and accept the <a href='http://pub.uni-bielefeld.de/policy.html#depositpolicy' target='_blank'>PUB Deposit Policy</a></label></div><input type='hidden' name='tempid' value='"+l.tempid+"' /><input type='submit' class='btn btn-success' name='submit_or_cancel' value='Submit'/> <input type='reset' class='btn btn-warning' onclick='location.reload()' name='submit_or_cancel' value='Cancel' /></form></div>");e.previewElement.appendChild(i)}),this.on("error",function(e,a){var t=Dropzone.createElement("<div class='alert alert-danger'>"+a+"</div>");e.previewElement.appendChild(t)})}},Dropzone.options.uploadFiles={url:"/myPUB/upload",maxFileSize:1e3,previewTemplate:'<div class="col-md-11 dz-preview dz-file-preview"></div>',dictDefaultMessage:"Drop files here to upload ... or click!",createImageThumbnails:!1,init:function(){$(".dz-default.dz-message").addClass("col-md-11"),this.on("addedfile",function(e){var a=Dropzone.createElement('<div class="row"><div class="progress progress-striped active"><div class="progress-bar" id="'+e.name+'_progress" style="width:0;text-align:left;padding-left:10px;">'+e.name+"</span></div></div></div>");e.previewElement.appendChild(a)}),this.on("uploadprogress",function(e,a){var t=document.getElementById(e.name+"_progress");t.style.width=a+"%"}),this.on("success",function(e,a){var t=document.getElementById(e.name+"_progress"),s=t.parentNode.parentNode;$(s).remove();var l=a;if(l.success){$(e.previewElement).addClass("alert alert-success");var i=Dropzone.createElement('<div class="row"><div class="col-md-12 padded text-muted" id="filename_'+l.tempid+'"><span class="glyphicon glyphicon-file text-muted"></span> <strong>'+e.name+"</strong></div></div>");e.previewElement.appendChild(i);var n=Dropzone.createElement('<div class="row"><div class="col-md-2 text-muted">Access Level:</div><div class="col-md-3 text-muted">Upload Date:</div><div class="col-md-3 text-muted">User:</div><div class="col-md-4 text-muted">Relation:</div></div>');e.previewElement.appendChild(n);var o=Dropzone.createElement('<div class="row"><div class="col-md-2" id="access_'+l.tempid+'"><span>'+l.access_level+"</span></div></div>");i.appendChild(o);var r=Dropzone.createElement('<div class="col-md-3" id="updated_'+l.tempid+'"><span>'+l.date_updated+"</span></div>");o.appendChild(r);var d=Dropzone.createElement('<div class="col-md-3" id="creator_'+l.tempid+'"><span>'+l.creator+"</span></div>");o.appendChild(d);var c=Dropzone.createElement('<div class="col-md-4" id="relation_'+l.tempid+'"><span>'+l.relation+"</span></div>");o.appendChild(c),e.previewElement.appendChild(o);var p=Dropzone.createElement('<div class="corner_up" id="corup_'+l.tempid+'"><a href="#"><span class="glyphicon glyphicon-remove"></span></a></div>');p.addEventListener("click",function(e){window.delete_file(l.tempid),e.preventDefault()}),e.previewElement.appendChild(p);var m=Dropzone.createElement('<div class="corner_down" id="cordown_'+l.tempid+'"><a href="#" onclick="return false;"><span class="glyphicon glyphicon-pencil"></span></a></div>');m.addEventListener("click",function(){window.edit_file(l.tempid,"[% _id %]")}),e.previewElement.appendChild(m);var v=document.getElementById("licenses");if(v){var u=v.className,h=/collapse in/,f=h.exec(u);f||v.setAttribute("class","collapse in"),$("#licenses").find("div.alert-info.mandatory").addClass("alert-danger"),$("#licenses").find("div.alert-info.mandatory").removeClass("alert-info"),$("#licenses").find('input[name="accept"]').attr("checked",!1),$("#select_ddc_0").addClass("mandatory"),$("#select_ddc_0").closest("div.input-group").addClass("mandatory"),$("#select_ddc_0").addClass("has-error"),$("#select_ddc_0").closest("div.input-group.mandatory").addClass("has-error")}e.previewElement.setAttribute("id",l.tempid);var g=Dropzone.createElement("<input type='hidden' id='file_"+l.tempid+"' name='file' value='"+l.file_json+"' />");e.previewElement.appendChild(g),$("#sortFilesInput").append('<input type="hidden" name="file_order" id="file_order_'+l.tempid+'" value="'+l.tempid+'" />')}})}},Dropzone.options.thesesUpload={url:"/myPUB/thesesupload",maxFileSize:1e3,maxFiles:1,previewTemplate:"<span></span>",previewsContainer:"#theses_dz_preview",params:{access_level:"open_access",accept:1,quickandeasy:1},createImageThumbnails:!1,dictDefaultMessage:'<span class="fa fa-file-pdf-o fa-3x"></span><br />Drop your thesis here.',dictMaxFilesExceeded:"Please submit or cancel your upload first before uploading more files.",init:function(){$(".dz-default.dz-message").addClass("qae"),this.on("addedfile",function(e){var a=Dropzone.createElement('<div class="row"><div class="progress progress-striped active"><div class="progress-bar" id="'+e.name+'_progress" style="width:0;text-align:left;padding-left:10px;">'+e.name+"</span></div></div></div>");e.previewElement.appendChild(a)}),this.on("uploadprogress",function(e,a){var t=document.getElementById(e.name+"_progress");t.style.width=a+"%"}),this.on("success",function(e,a){var t=document.getElementById(e.name+"_progress"),s=t.parentNode.parentNode;$(s).remove();var l=a,i=Dropzone.createElement("<div class='well' id='"+l.tempid+"'></div>"),n=Dropzone.createElement("<form class='form-horizontal' id='form_"+l.tempid+"' action='/myPUB/thesesupload/submit' method='post'></form>"),o=Dropzone.createElement("<h4 class='expert'><span class='fa fa-file-pdf-o'></span> "+e.name+"</h4>");n.appendChild(o);var r=Dropzone.createElement("<div class='form-group'><div class='col-sm-offset-2 col-sm-10'><div class='radio'><label><input type='radio' name='type' value='biDissertation' checked='checked'>Dissertation</label></div><div class='radio'><label><input type='radio' name='type' value='biMasterThesis'>Master Thesis</label></div><div class='radio'><label><input type='radio' name='type' value='biBachelorThesis'>Bachelor Thesis</label></div><div class='radio'><label><input type='radio' name='type'' value='biPostdocThesis'>Postdoc Thesis/Habilitation</label></div></div></div>");n.appendChild(r);var d=Dropzone.createElement("<div class='form-group'><label for='id_title' class='col-sm-2 control-label'>Title<span class='starMandatory'></span></label><div class='col-sm-10'><input type='text' name='title' class='form-control' id='id_title' placeholder='Title' required /></div></div>");n.appendChild(d);var c=Dropzone.createElement("<div class='form-group'><label class='col-sm-2 control-label'>Author<span class='starMandatory'></span></label><div class='col-sm-5'><input type='text' name='author.first_name' class='form-control' placeholder='First Name' required /></div><div class='col-sm-5'><input type='text' name='author.last_name' class='form-control' placeholder='Last Name' /></div></div>");n.appendChild(c);var p=Dropzone.createElement("<div class='form-group'><label for='id_email' class='col-sm-2 control-label'>Email<span class='starMandatory'></span></label><div class='col-sm-10'><input type='email' class='form-control' id='id_email' placeholder='Email' name='email' required /></div></div>");n.appendChild(p);var m=Dropzone.createElement("<div class='form-group'><label class='col-sm-2 control-label'>Supervisor<span class='starMandatory'></span></label><div class='col-sm-5'><input type='text' name='supervisor.first_name' class='form-control' placeholder='First Name' required /></div><div class='col-sm-5'><input type='text' name='supervisor.last_name' class='form-control' placeholder='Last Name' /></div></div>");n.appendChild(m);var v=Dropzone.createElement("<div class='form-group'><label class='col-sm-2 control-label'>Defense Date<span class='starMandatory'></span></label><div class='col-sm-5'><input type='text' name='defense_date' class='form-control' placeholder='YYYY-MM-DD' required /></div></div>'");n.appendChild(v);var u=Dropzone.createElement("<div class='row innerrow'><div class='col-md-12 alert alert-info'>If your uploaded data is available under a Creative Commons license, you can select it here:<br /><select name='cc_license' id='id_cc_license' class='form-control'><option value=''>Select a license</option><option value='cc_0'>CC0 (1.0)</option><option value='cc_by'>CC BY (4.0)</option><option value='cc_by_sa'>CC BY-SA (4.0)</option></select><br /><a data-target='#cc_0' data-toggle='collapse'><span class='glyphicon glyphicon-chevron-down'></span> Creative Commons Public Domain Dedication (CC0 1.0)</a><br /><div id='cc_0' class='collapse reuse-license'><img src='/images/cc0.png' /><br />License Deed <a href='http://creativecommons.org/publicdomain/zero/1.0/' target='_blank'>http://creativecommons.org/publicdomain/zero/1.0/</a><br /><a href='http://creativecommons.org/publicdomain/zero/1.0/legalcode' target='_blank'>http://creativecommons.org/publicdomain/zero/1.0/legalcode</a></div><a data-target='#cc_by' data-toggle='collapse'><span class='glyphicon glyphicon-chevron-down'></span> Creative Commons Attribution 4.0 International Public License (CC-BY 4.0)</a><br /><div id='cc_by' class='collapse reuse-license'><img src='/images/cc_by.png' /><br />License Deed <a href='http://creativecommons.org/licenses/by/4.0/' target='_blank'>http://creativecommons.org/licenses/by/4.0/</a><br /><a href='http://creativecommons.org/licenses/by/4.0/legalcode' target='_blank'>http://creativecommons.org/licenses/by/4.0/legalcode</a></div><a data-target='#cc_by_sa' data-toggle='collapse'><span class='glyphicon glyphicon-chevron-down'></span> Creative Commons Attribution-ShareAlike 4.0 International Public License (CC BY-SA 4.0)</a><br /><div id='cc_by_sa' class='collapse reuse-license'><img src='/images/cc_by_sa.png' /><br />License Deed <a href='http://creativecommons.org/licenses/by-sa/4.0/' target='_blank'>http://creativecommons.org/licenses/by-sa/4.0/</a><br /><a href='http://creativecommons.org/licenses/by-sa/4.0/legalcode' target='_blank'>http://creativecommons.org/licenses/by-sa/4.0/legalcode</a></div></div></div>");n.appendChild(u);var h=Dropzone.createElement("<input type='hidden' name='file_name' value='"+l.file_name+"' />"),f=Dropzone.createElement("<input type='hidden' name='tempid' value='"+l.tempid+"' />");n.appendChild(h),n.appendChild(f);var g=Dropzone.createElement("<div class='form-group'><div class='col-sm-10 col-sm-offset-2'><input type='submit' class='btn btn-default' name='submit_or_cancel' onclick='return confirm(\"I herewith place this document at the disposal of Bielefeld University for the purpose of storing in electronic form and making it available to the public according to the PUB Deposit Policy.\");' value='Submit'/><input type='button' class='btn btn-default' onclick='location.reload();' value='Cancel' /></div></div>");n.appendChild(g),i.appendChild(n),e.previewElement.appendChild(i)}),this.on("error",function(e,a){var t=Dropzone.createElement("<div class='alert alert-danger'>"+a+"</div>");e.previewElement.appendChild(t)})}}});